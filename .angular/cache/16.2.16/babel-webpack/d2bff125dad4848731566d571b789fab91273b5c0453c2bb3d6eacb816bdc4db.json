{"ast":null,"code":"!function (e, t) {\n  \"object\" == typeof exports && \"undefined\" != typeof module ? module.exports = t() : \"function\" == typeof define && define.amd ? define(t) : (e = \"undefined\" != typeof globalThis ? globalThis : e || self).ImageKit = t();\n}(this, function () {\n  \"use strict\";\n\n  function e(t) {\n    return (e = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n      return typeof e;\n    } : function (e) {\n      return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n    })(t);\n  }\n  function t(e, t) {\n    for (var n = 0; n < t.length; n++) {\n      var r = t[n];\n      r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n    }\n  }\n  function n(e, t, n) {\n    return t in e ? Object.defineProperty(e, t, {\n      value: n,\n      enumerable: !0,\n      configurable: !0,\n      writable: !0\n    }) : e[t] = n, e;\n  }\n  function r(e, t) {\n    var n = Object.keys(e);\n    if (Object.getOwnPropertySymbols) {\n      var r = Object.getOwnPropertySymbols(e);\n      t && (r = r.filter(function (t) {\n        return Object.getOwnPropertyDescriptor(e, t).enumerable;\n      })), n.push.apply(n, r);\n    }\n    return n;\n  }\n  function o(e) {\n    for (var t = 1; t < arguments.length; t++) {\n      var o = null != arguments[t] ? arguments[t] : {};\n      t % 2 ? r(Object(o), !0).forEach(function (t) {\n        n(e, t, o[t]);\n      }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(o)) : r(Object(o)).forEach(function (t) {\n        Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(o, t));\n      });\n    }\n    return e;\n  }\n  function a(e, t) {\n    (null == t || t > e.length) && (t = e.length);\n    for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];\n    return r;\n  }\n  function i(e, t) {\n    var n;\n    if (\"undefined\" == typeof Symbol || null == e[Symbol.iterator]) {\n      if (Array.isArray(e) || (n = function (e, t) {\n        if (e) {\n          if (\"string\" == typeof e) return a(e, t);\n          var n = Object.prototype.toString.call(e).slice(8, -1);\n          return \"Object\" === n && e.constructor && (n = e.constructor.name), \"Map\" === n || \"Set\" === n ? Array.from(e) : \"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? a(e, t) : void 0;\n        }\n      }(e)) || t && e && \"number\" == typeof e.length) {\n        n && (e = n);\n        var r = 0,\n          o = function () {};\n        return {\n          s: o,\n          n: function () {\n            return r >= e.length ? {\n              done: !0\n            } : {\n              done: !1,\n              value: e[r++]\n            };\n          },\n          e: function (e) {\n            throw e;\n          },\n          f: o\n        };\n      }\n      throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n    }\n    var i,\n      s = !0,\n      u = !1;\n    return {\n      s: function () {\n        n = e[Symbol.iterator]();\n      },\n      n: function () {\n        var e = n.next();\n        return s = e.done, e;\n      },\n      e: function (e) {\n        u = !0, i = e;\n      },\n      f: function () {\n        try {\n          s || null == n.return || n.return();\n        } finally {\n          if (u) throw i;\n        }\n      }\n    };\n  }\n  var s = {\n      message: \"Missing urlEndpoint during SDK initialization\",\n      help: \"\"\n    },\n    u = {\n      message: \"Invalid transformationPosition parameter\",\n      help: \"\"\n    },\n    c = {\n      message: \"Missing file parameter for upload\",\n      help: \"\"\n    },\n    p = {\n      message: \"Missing fileName parameter for upload\",\n      help: \"\"\n    },\n    f = {\n      message: \"Missing public key for upload\",\n      help: \"\"\n    },\n    l = {\n      message: \"Request to ImageKit upload endpoint failed due to network error\",\n      help: \"\"\n    },\n    d = {\n      message: \"Invalid uploadOptions parameter\",\n      help: \"\"\n    },\n    h = {\n      message: \"Missing signature for upload. The SDK expects token, signature and expire for authentication.\",\n      help: \"\"\n    },\n    m = {\n      message: \"Missing token for upload. The SDK expects token, signature and expire for authentication.\",\n      help: \"\"\n    },\n    g = {\n      message: \"Missing expire for upload. The SDK expects token, signature and expire for authentication.\",\n      help: \"\"\n    },\n    y = {\n      message: \"Invalid transformation parameter. Please include at least pre, post, or both.\",\n      help: \"\"\n    },\n    v = {\n      message: \"Invalid pre transformation parameter.\",\n      help: \"\"\n    },\n    b = {\n      message: \"Invalid post transformation parameter.\",\n      help: \"\"\n    };\n  function w(e, t, n) {\n    \"function\" == typeof n && (e ? n(t, null) : n(null, t));\n  }\n  function O(e) {\n    var t = {},\n      n = e.getAllResponseHeaders();\n    return Object.keys(n).length && n.trim().split(/[\\r\\n]+/).map(function (e) {\n      return e.split(/: /);\n    }).forEach(function (e) {\n      t[e[0].trim()] = e[1].trim();\n    }), t;\n  }\n  var x = function (e, t) {\n      var n = o({}, e),\n        r = {\n          statusCode: t.status,\n          headers: O(t)\n        };\n      return Object.defineProperty(n, \"$ResponseMetadata\", {\n        value: r,\n        enumerable: !1,\n        writable: !1\n      }), n;\n    },\n    j = function (e, t) {\n      return new Promise(function (n, r) {\n        e.open(\"POST\", \"https://upload.imagekit.io/api/v1/files/upload\"), e.onerror = function (e) {\n          return r(l);\n        }, e.onload = function () {\n          if (200 === e.status) try {\n            var t = JSON.parse(e.responseText),\n              o = x(t, e);\n            return n(o);\n          } catch (e) {\n            return r(e);\n          } else try {\n            t = JSON.parse(e.responseText);\n            var a = x(t, e);\n            return r(a);\n          } catch (e) {\n            return r(e);\n          }\n        }, e.send(t);\n      });\n    },\n    k = function (t, n, r, o) {\n      if (n.file) {\n        if (n.fileName) {\n          if (r.publicKey) {\n            if (n.token) {\n              if (n.signature) {\n                if (n.expire) {\n                  if (n.transformation) {\n                    if (!Object.keys(n.transformation).includes(\"pre\") && !Object.keys(n.transformation).includes(\"post\")) return void w(!0, y, o);\n                    if (Object.keys(n.transformation).includes(\"pre\") && !n.transformation.pre) return void w(!0, v, o);\n                    if (Object.keys(n.transformation).includes(\"post\")) {\n                      if (!Array.isArray(n.transformation.post)) return void w(!0, b, o);\n                      var a,\n                        s = i(n.transformation.post);\n                      try {\n                        for (s.s(); !(a = s.n()).done;) {\n                          var u = a.value;\n                          if (\"abs\" === u.type && !u.protocol && !u.value) return void w(!0, b, o);\n                          if (\"transformation\" === u.type && !u.value) return void w(!0, b, o);\n                        }\n                      } catch (e) {\n                        s.e(e);\n                      } finally {\n                        s.f();\n                      }\n                    }\n                  }\n                  var l,\n                    d = new FormData();\n                  for (l in n) l && (\"file\" === l && \"string\" != typeof n.file ? d.append(\"file\", n.file, String(n.fileName)) : \"tags\" === l && Array.isArray(n.tags) ? d.append(\"tags\", n.tags.join(\",\")) : \"signature\" === l ? d.append(\"signature\", n.signature) : \"expire\" === l ? d.append(\"expire\", String(n.expire)) : \"token\" === l ? d.append(\"token\", n.token) : \"responseFields\" === l && Array.isArray(n.responseFields) ? d.append(\"responseFields\", n.responseFields.join(\",\")) : \"extensions\" === l && Array.isArray(n.extensions) ? d.append(\"extensions\", JSON.stringify(n.extensions)) : \"customMetadata\" !== l || \"object\" !== e(n.customMetadata) || Array.isArray(n.customMetadata) || null === n.customMetadata ? \"transformation\" === l && \"object\" === e(n.transformation) && null !== n.transformation ? d.append(l, JSON.stringify(n.transformation)) : \"checks\" === l && n.checks ? d.append(\"checks\", n.checks) : void 0 !== n[l] && d.append(l, String(n[l])) : d.append(\"customMetadata\", JSON.stringify(n.customMetadata)));\n                  d.append(\"publicKey\", r.publicKey), function (e, t, n) {\n                    j(e, t).then(function (e) {\n                      return w(!1, e, n);\n                    }, function (e) {\n                      return w(!0, e, n);\n                    });\n                  }(t, d, o);\n                } else w(!0, g, o);\n              } else w(!0, h, o);\n            } else w(!0, m, o);\n          } else w(!0, f, o);\n        } else w(!0, p, o);\n      } else w(!0, c, o);\n    },\n    S = {\n      width: \"w\",\n      height: \"h\",\n      aspectRatio: \"ar\",\n      background: \"bg\",\n      border: \"b\",\n      crop: \"c\",\n      cropMode: \"cm\",\n      dpr: \"dpr\",\n      focus: \"fo\",\n      quality: \"q\",\n      x: \"x\",\n      xCenter: \"xc\",\n      y: \"y\",\n      yCenter: \"yc\",\n      format: \"f\",\n      videoCodec: \"vc\",\n      audioCodec: \"ac\",\n      radius: \"r\",\n      rotation: \"rt\",\n      blur: \"bl\",\n      named: \"n\",\n      defaultImage: \"di\",\n      flip: \"fl\",\n      original: \"orig\",\n      startOffset: \"so\",\n      endOffset: \"eo\",\n      duration: \"du\",\n      streamingResolutions: \"sr\",\n      grayscale: \"e-grayscale\",\n      aiUpscale: \"e-upscale\",\n      aiRetouch: \"e-retouch\",\n      aiVariation: \"e-genvar\",\n      aiDropShadow: \"e-dropshadow\",\n      aiChangeBackground: \"e-changebg\",\n      aiRemoveBackground: \"e-bgremove\",\n      aiRemoveBackgroundExternal: \"e-removedotbg\",\n      contrastStretch: \"e-contrast\",\n      shadow: \"e-shadow\",\n      sharpen: \"e-sharpen\",\n      unsharpMask: \"e-usm\",\n      gradient: \"e-gradient\",\n      progressive: \"pr\",\n      lossless: \"lo\",\n      colorProfile: \"cp\",\n      metadata: \"md\",\n      opacity: \"o\",\n      trim: \"t\",\n      zoom: \"z\",\n      page: \"pg\",\n      fontSize: \"fs\",\n      fontFamily: \"ff\",\n      fontColor: \"co\",\n      innerAlignment: \"ia\",\n      padding: \"pa\",\n      alpha: \"al\",\n      typography: \"tg\",\n      lineHeight: \"lh\",\n      fontOutline: \"fol\",\n      fontShadow: \"fsh\",\n      raw: \"raw\"\n    },\n    A = [\"path\", \"query\"],\n    P = function () {\n      return \"query\";\n    },\n    R = function (e) {\n      return \"query\" === e.transformationPosition;\n    },\n    C = function (e) {\n      return void 0 !== e.transformationPosition && -1 != A.indexOf(e.transformationPosition);\n    },\n    M = function (e) {\n      return e && (S[e] || S[e.toLowerCase()]) || \"\";\n    },\n    I = function () {\n      return \":\";\n    },\n    E = function () {\n      return \",\";\n    },\n    U = function () {\n      return \"-\";\n    },\n    q = function (e) {\n      return \"undefined\" != typeof window ? btoa(e) : Buffer.from(e, \"utf8\").toString(\"base64\");\n    },\n    D = new RegExp(\"^[a-zA-Z0-9-._/ ]*$\"),\n    K = new RegExp(\"^[a-zA-Z0-9-._ ]*$\");\n  function T(e) {\n    return \"string\" == typeof e && \"/\" == e[e.length - 1] && (e = e.substring(0, e.length - 1)), e;\n  }\n  function N(e) {\n    return \"string\" == typeof e && \"/\" == e[0] && (e = e.slice(1)), e;\n  }\n  function z(e, t) {\n    var n = t || \"/\",\n      r = new RegExp(n + \"{1,}\", \"g\");\n    return e.join(n).replace(r, n);\n  }\n  function F(e, t) {\n    return e = T(N(e)), \"plain\" === t ? \"i-\".concat(e.replace(/\\//g, \"@@\")) : \"base64\" === t ? \"ie-\".concat(encodeURIComponent(q(e))) : D.test(e) ? \"i-\".concat(e.replace(/\\//g, \"@@\")) : \"ie-\".concat(encodeURIComponent(q(e)));\n  }\n  function J(e) {\n    var t = [];\n    if (e) {\n      var n = e.type,\n        r = e.position,\n        o = void 0 === r ? {} : r,\n        a = e.timing,\n        i = void 0 === a ? {} : a,\n        s = e.transformation,\n        u = void 0 === s ? [] : s;\n      if (!n) throw new Error(\"Overlay type is required\");\n      switch (n) {\n        case \"text\":\n          var c = e;\n          if (!c.text) return;\n          var p = c.encoding || \"auto\";\n          t.push(\"l-text\"), t.push(function (e, t) {\n            return \"plain\" === t ? \"i-\".concat(encodeURIComponent(e)) : \"base64\" === t ? \"ie-\".concat(encodeURIComponent(q(e))) : K.test(e) ? \"i-\".concat(encodeURIComponent(e)) : \"ie-\".concat(encodeURIComponent(q(e)));\n          }(c.text, p));\n          break;\n        case \"image\":\n          t.push(\"l-image\");\n          var f = e,\n            l = f.encoding || \"auto\";\n          if (!f.input) return;\n          t.push(F(f.input, l));\n          break;\n        case \"video\":\n          t.push(\"l-video\");\n          var d = e,\n            h = d.encoding || \"auto\";\n          if (!d.input) return;\n          t.push(F(d.input, h));\n          break;\n        case \"subtitle\":\n          t.push(\"l-subtitle\");\n          var m = e,\n            g = m.encoding || \"auto\";\n          if (!m.input) return;\n          t.push(F(m.input, g));\n          break;\n        case \"solidColor\":\n          t.push(\"l-image\"), t.push(\"i-ik_canvas\");\n          var y = e;\n          if (!y.color) return;\n          t.push(\"bg-\".concat(y.color));\n      }\n      var v = o.x,\n        b = o.y,\n        w = o.focus;\n      v && t.push(\"lx-\".concat(v)), b && t.push(\"ly-\".concat(b)), w && t.push(\"lfo-\".concat(w));\n      var O = i.start,\n        x = i.end,\n        j = i.duration;\n      O && t.push(\"lso-\".concat(O)), x && t.push(\"leo-\".concat(x)), j && t.push(\"ldu-\".concat(j));\n      var k = L(u);\n      return k && \"\" !== k.trim() && t.push(k), t.push(\"l-end\"), t.join(E());\n    }\n  }\n  function L(t) {\n    if (!Array.isArray(t)) return \"\";\n    for (var n = [], r = 0, o = t.length; r < o; r++) {\n      var a = [];\n      for (var i in t[r]) {\n        var s = t[r][i];\n        if (null != s) if (\"overlay\" !== i || \"object\" !== e(s)) {\n          var u = M(i);\n          if (u || (u = i), \"\" !== u) if ([\"e-grayscale\", \"e-contrast\", \"e-removedotbg\", \"e-bgremove\", \"e-upscale\", \"e-retouch\", \"e-genvar\"].includes(u)) {\n            if (!0 !== s && \"-\" !== s && \"true\" !== s) continue;\n            a.push(u);\n          } else ![\"e-sharpen\", \"e-shadow\", \"e-gradient\", \"e-usm\", \"e-dropshadow\"].includes(u) || \"\" !== s.toString().trim() && !0 !== s && \"true\" !== s ? \"raw\" === i ? a.push(t[r][i]) : (\"di\" === u && (s = (s = T(N(s || \"\"))).replace(/\\//g, \"@@\")), \"sr\" === u && Array.isArray(s) && (s = s.join(\"_\")), \"t\" === u && \"\" === s.toString().trim() && (s = \"true\"), a.push([u, s].join(U()))) : a.push(u);\n        } else {\n          var c = J(s);\n          c && \"\" !== c.trim() && a.push(c);\n        }\n      }\n      a.length && n.push(a.join(E()));\n    }\n    return n.join(I());\n  }\n  var B = function (e, t) {\n    return function (e) {\n      if (!e.path && !e.src) return \"\";\n      var t, n, r;\n      try {\n        e.path ? (r = new URL(e.urlEndpoint).pathname, t = new URL(z([e.urlEndpoint.replace(r, \"\"), e.path]))) : (t = new URL(e.src), n = !0);\n      } catch (e) {\n        return console.error(e), \"\";\n      }\n      for (var o in e.queryParameters) t.searchParams.append(o, String(e.queryParameters[o]));\n      var a = L(e.transformation);\n      return a && a.length && (R(e) || n || (t.pathname = z([\"tr\" + I() + a, t.pathname]))), t.pathname = z(r ? [r, t.pathname] : [t.pathname]), a && a.length && (R(e) || n) ? \"\" !== t.searchParams.toString() ? \"\".concat(t.href, \"&\").concat(\"tr\", \"=\").concat(a) : \"\".concat(t.href, \"?\").concat(\"tr\", \"=\").concat(a) : t.href;\n    }(o(o({}, t), e));\n  };\n  return function () {\n    function r(e) {\n      if (function (e, t) {\n        if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n      }(this, r), n(this, \"options\", {\n        publicKey: \"\",\n        urlEndpoint: \"\",\n        transformationPosition: P()\n      }), this.options = o(o({}, this.options), e || {}), !this.options.urlEndpoint) throw s;\n      if (!C(this.options)) throw u;\n    }\n    var a, i, c;\n    return a = r, (i = [{\n      key: \"url\",\n      value: function (e) {\n        return B(e, this.options);\n      }\n    }, {\n      key: \"upload\",\n      value: function (t, n, r) {\n        var a;\n        if (\"function\" == typeof n ? a = n : r = n || {}, !t || \"object\" !== e(t)) return w(!0, d, a);\n        var i = o(o({}, this.options), r),\n          s = (t || {}).xhr;\n        delete t.xhr;\n        var u,\n          c,\n          p = s || new XMLHttpRequest();\n        return (u = this, c = k, function () {\n          for (var e = arguments.length, t = new Array(e), n = 0; n < e; n++) t[n] = arguments[n];\n          if (t.length !== c.length || void 0 === t[t.length - 1]) return new Promise(function (e, n) {\n            t.pop(), t.push(function (t) {\n              if (t) return n(t);\n              for (var r = arguments.length, o = new Array(r > 1 ? r - 1 : 0), a = 1; a < r; a++) o[a - 1] = arguments[a];\n              e(o.length > 1 ? o : o[0]);\n            }), c.call.apply(c, [u].concat(t));\n          });\n          if (\"function\" != typeof t[t.length - 1]) throw new Error(\"Callback must be a function.\");\n          c.call.apply(c, [u].concat(t));\n        })(p, t, i, a);\n      }\n    }]) && t(a.prototype, i), c && t(a, c), r;\n  }();\n});","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}